<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <base href="mobile/" />
    <title>Mobile Angular UI Demo</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimal-ui" />
    <meta name="apple-mobile-web-app-status-bar-style" content="yes" />
    <link rel="stylesheet" href="css/mobile-angular-ui-hover.min.css" />
    <link rel="stylesheet" href="css/mobile-angular-ui-base.min.css" />
    <link rel="stylesheet" href="css/mobile-angular-ui-desktop.min.css" />
    <link rel="stylesheet" href="css/addition.css" />
	<script src="js/jquery-1.10.1.min.js"></script>
	<script src="js/tabs.js"></script>
    <script src="lib/angular.min.js"></script>
    <script src="lib/angular-ui-router.min.js"></script>
    <script src="lib/mobile-angular-ui.min.js"></script>
    <script src="lib/mobile-angular-ui.gestures.js"></script>
    <script src="lib/leither-cloud.js"></script>
    <script src="lib/spin.min.js"></script>
    <script src="js/GlobalDataStruct.js"></script>
    <script src="js/mobile.js"></script>
    <script src="js/root.js"></script>
    <script src="js/states.js"></script>
    <script src="js/message.js"></script>
    <script src="js/review.js"></script>
    <script src="js/sms.js"></script>
<script type="text/javascript">
//define some globals
	//customize log function. Disable it by setting isDebug to false
	function setDebug(isDebug) {
		if (isDebug) {
			window.debug = {
				log: window.console.log.bind(window.console),
				error: window.console.error.bind(window.console),
				info: window.console.info.bind(window.console),
				warn: window.console.warn.bind(window.console)
			};
		} else {
			var __no_op = function() {};
			window.debug = {
				log: __no_op,
				error: __no_op,
				warn: __no_op,
				info: __no_op
			}
		}
	};
	setDebug(true);

	//if there is no inviter, then there is no userppt. Use appPpt as userppt
	if (G.inviter === '%%inviter%%')
		G.userppt = G.appPpt;
	G.leClient.login(null, G.userppt, function(sid) {
		G.sid = sid;
		G.leClient.getvar(sid, 'self', function(usr) {
			G.bid = usr.id;
			debug.log("login with ppt, sid=" + G.sid, "bid=" + G.bid);

			//start app after login
			//G.weiboApp = angular.module("appModule", ["mobile-angular-ui"])
			angular.bootstrap(document, [ 'appModule' ]);
			debug.log("auglar started")
		}, function(name, err) {
			debug.error("getSysUser err=" + err);
		});
	}, function(name, err) {
		debug.error(err);
	});
</script>
</head>

<body ng-controller="appController" class="b-hui">
<div ui-view>Hello world(1)</div>

<!-- html templates begin -->
<script type="text/ng-template" id="send.html">
<div class="container">
<form name="weiboForm" ng-submit="" novalidate>  
 <div class="row head-nav">
  <div class="send-nav f18">
    <div class="pull-left send-qx"><a href="javascript:void(0)" onclick="history.back()" class="c-org">取消</a></div>
    <div class="pull-left send-wb text-center">发微博</div>
    <div class="pull-left send-fs text-right"><a ng-click="(!P.txtInvalid) && addNewPost()" href="javascript:void(0)" class="c-999">发送</a></div>
	</div>
  </div>
  <div class="row send-main">
    <textarea ng-model="wbText" ng-change="wbtxtChanged()" name="textarea" id="textarea" class="send-text" placeholder="私语分享..."></textarea>
  </div>
  <div class="row b-hui">
     <div class="send-more">
	  <a href="javascript:void(0)" onclick="fileSelect();"><img src="images/img.png" width="24"/></a>
	  <input type="file" onchange="angular.element(this).scope().fileSelected(this.files)" name="fileToUpload" id="fileToUpload" multiple accept="image/*" style="display:none;">
	 </div>
	 <div class="send-img">
	   <ul>
	     <li ng-repeat="url in tmpPicUrls track by $index">
			<a href="javascript:void(0)"><img ng-src="{{url}}"/></a><i><a ng-click="delPic($index)" href="javascript:void(0)"></a></i>
		 </li>
	     <li><a href="javascript:void(0)" onclick="fileSelect();"><img src="images/pho2.jpg"/></a></li>
	   </ul>
	 </div>
  </div>
</form>
</div>
</script>
<script type="text/ng-template" id="main.html">
<div class="container">
 <div class="row head-nav">
  <div class="sy-nav">
    <div class="pull-left f24 ml10">{{myUserInfo.nickName}}<img src="images/btn1.png" width="11" class="vm ml10"/></div>
	<div class="pull-right mr20 vm">
	<a ui-sref="root.newPost"><img src="images/btn2.png" width="22"></a>
	<a href="javascript:void(0)" class="ml25" onclick="history.go(0)"><img src="images/fresh.png" width="20"></a>
	</div>
  </div>
  <div class="sy-tab f20 b-fff">
    <ul>
	  <li class="nav-active"><a href="javascript:void(0)"><span class="tb1"></span>首页</a></li>
	  <li><a href="javascript:void(0)"><span class="tb2"></span>信息</a></li>
	  <li><a href="javascript:void(0)"><span class="tb3"></span>我</a></li>
	</ul>
  </div>
  </div>
  <div class="row list-info">
  <div class="main-info">
 	<div ui-view>weiboList</div>
  </div>
  <div class="main-info" style="display:none;">
    <div class="mt10 b-fff">
     22222222222222
    </div>  
  </div>
  <div class="main-info" style="display:none;">
    <div class="mt10 b-fff">
     333333333333333
    </div>  
  </div>
  </div>
</div>
</script>
<script type="text/ng-template" id="weiboList.html">
  <div class="mt10 b-fff" ng-repeat="wb in currentList track by $index">
	   <div class="ptb10 overf">
	      <div class="sy-photo pull-left mr10"><img ng-src="{{myUserInfo.friends[wb.authorID].headPicUrl || myUserInfo.headPicUrl}}" width="100%"/></div>
		  <div class="pull-left mt15">
		    <p class="c-org f20">{{wb.author}}</p>
	        <p class="c-999">{{wb.timeStamp | timePassed}}</p>
		  </div>
		  <div class="pull-right"><img src="images/down.png" width="18"/></div>
	   </div>
	   <div class="c-999 clear ptb10">{{wb.body}}</div>
	   <div class="three-pic ptb10">
	      <ul>
		    <li ng-repeat="pic in wb.pictures track by $index">
				<a href="javascript:void(0);"><img ng-src="{{pic.dataURI}}"></img></a>
			</li>
		  </ul>
	   </div>
	   <div ng-if="wb.parentID!==null && wb.parentWeibo!==null" class="pl-list">
	     <div class="mb10 c-999">
		  <span class="c-blue">@张杰：</span>{{wb.parentWeibo.body}}
		 </div>
	     <div class="three-pic">
	      <ul>
		    <li ng-repeat="pic in wb.parentWeibo.pictures track by $index">
				<a href="javascript:void(0);"><img ng-src="{{pic.dataURI}}"></img></a>
			</li>
		  </ul>
	     </div>
	   </div>
	   <div class="sy-zan c-999 mt10">
	      <ul>
		    <li>
			 <a ng-click="myUserInfo.toggleFavorite(wb)" ng-hide="wb.isFavorite" href="javascript:void(0)" class="c-999"><img src="images/sc.png" width="16" class="vm mr5"/>收藏</a>
			 <a ng-click="myUserInfo.toggleFavorite(wb)" ng-show="wb.isFavorite" href="javascript:void(0)" class="c-org"><img src="images/sc2.png" width="16" class="vm mr5"/>取消</a>
			</li>
		    <li class="sy-fg">
			 <a href="javascript:void(0)" class="c-999"><img src="images/zf.png" width="13" class="vm mr5"/>{{wb.relays.length | bracket}}</a>
			 <a href="javascript:void(0)" class="c-org" style="display:none;"><img src="images/zf2.png" width="13" class="vm mr5"/>111</a>
			</li>
		    <li>
			 <a href="javascript:void(0)" class="c-999"><img src="images/pl.png" width="17" class="vm mr5"/>{{wb.reviews.length | bracket}}</a>
			 <a href="javascript:void(0)" class="c-org" style="display:none;"><img src="images/pl2.png" width="17" class="vm mr5"/>226</a>
			</li>
		  </ul>
	   </div>
  </div>
</script>
<!-- html end -->
</body>
</html>
